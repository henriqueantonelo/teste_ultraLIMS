<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="script.js"></script>
    <title>Registration Form</title>
  </head>
  <body>
    <form id="registrationForm">
      <label for="rua">Rua:</label>
      <input type="text" id="rua" name="rua" required />
      <label for="bairro">Bairro:</label>
      <input type="text" id="bairro" name="bairro" required />
      <label for="cidade">Cidade:</label>
      <input type="text" id="cidade" name="cidade" required />
      <label for="uf">UF:</label>
      <input type="text" id="uf" name="uf" required />
      <label for="ibge">IBGE:</label>
      <input type="text" id="ibge" name="ibge" required />
      <button type="submit">Register</button>
    </form>
    <!-- //////////////////////////////////////////// -->
    <div id="userDataContainer">
      <table id="userDataTable" border="1">
        <thead>
          <tr>
            <th>Rua</th>
            <th>Bairro</th>
            <th>Cidade</th>
            <th>UF</th>
            <th>IBGE</th>
          </tr>
        </thead>
        <tbody>
          <!-- Table body will be dynamically populated -->
        </tbody>
      </table>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("registrationForm");
        const tableBody = document.querySelector("#userDataTable tbody");

        // Load existing user data from localStorage when the page loads
        let savedUserData = JSON.parse(localStorage.getItem("userData")) || [];

        // Function to render table rows based on user data
        function renderUserTable() {
          tableBody.innerHTML = ""; // Clear existing table rows

          // Check if savedUserData is an array
          if (!Array.isArray(savedUserData)) {
            savedUserData = []; // Reset to empty array if not valid
          }

          savedUserData.forEach((userData) => {
            const newRow = document.createElement("tr");
            //////
            const fullNameCell = document.createElement("td");
            const emailCell = document.createElement("td");
            const passwordCell = document.createElement("td");
            const ufCell = document.createElement("td");
            const ibgeCell = document.createElement("td");

            fullNameCell.textContent = userData.bairro;
            emailCell.textContent = userData.cidade;
            passwordCell.textContent = userData.rua;
            ufCell.textContent = userData.uf;
            ibgeCell.textContent = userData.ibge;

            newRow.appendChild(fullNameCell);
            newRow.appendChild(emailCell);
            newRow.appendChild(passwordCell);
            newRow.appendChild(ufCell);
            newRow.appendChild(ibgeCell);

            tableBody.appendChild(newRow);
          });
        }

        // Render existing user data when the page loads
        renderUserTable();

        form.addEventListener("submit", function (event) {
          event.preventDefault(); // Prevent form submission

          // Get form values
          const bairro = document.getElementById("bairro").value;
          const rua = document.getElementById("rua").value;
          const cidade = document.getElementById("cidade").value;
          const uf = document.getElementById("uf").value;
          const ibge = document.getElementById("ibge").value;

          // Create new user data object
          const newUser = {
            bairro: bairro,
            rua: rua,
            cidade: cidade,
            uf: uf,
            ibge: ibge,
          };

          // Add new user data to the savedUserData array
          savedUserData.push(newUser);

          // Save updated user data to localStorage
          localStorage.setItem("userData", JSON.stringify(savedUserData));

          // Render updated table with new user data
          renderUserTable();

          // Clear form fields after submission
          form.reset();
        });
      });
    </script>
  </body>
</html>
